CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `c01`.`view_billinglist` AS select distinct `details`.`OrderID` AS `OrderID`,if((`details`.`BillingMonth` <= 0),1,`details`.`BillingMonth`) AS `BillingMonth`,(((((if(((`c01`.`tbl_order`.`CustomerInsurance1_ID` is not null) and (`details`.`BillIns1` = 1)),1,0) + if(((`c01`.`tbl_order`.`CustomerInsurance2_ID` is not null) and (`details`.`BillIns2` = 1)),2,0)) + if(((`c01`.`tbl_order`.`CustomerInsurance3_ID` is not null) and (`details`.`BillIns3` = 1)),4,0)) + if(((`c01`.`tbl_order`.`CustomerInsurance4_ID` is not null) and (`details`.`BillIns4` = 1)),8,0)) + if((`details`.`EndDate` is not null),32,0)) + if((`details`.`AcceptAssignment` = 1),16,0)) AS `BillingFlags`,`c01`.`tbl_customer`.`BillingTypeID` AS `BillingTypeID` from ((`c01`.`view_orderdetails_core` `details` join `c01`.`tbl_order` on(((`c01`.`tbl_order`.`ID` = `details`.`OrderID`) and (`c01`.`tbl_order`.`CustomerID` = `details`.`CustomerID`)))) left join `c01`.`tbl_customer` on((`c01`.`tbl_customer`.`ID` = `c01`.`tbl_order`.`CustomerID`))) where (((`details`.`InvoiceDate` <= curdate()) or (`details`.`EndDate` <= curdate())) and (`details`.`MIR` = '') and (`details`.`IsActive` = 1) and (isnull(`details`.`EndDate`) or (`c01`.`tbl_order`.`BillDate` < `details`.`EndDate`)) and (`c01`.`tbl_order`.`MIR` = '') and (`c01`.`tbl_order`.`Approved` = 1) and (`c01`.`tbl_order`.`OrderDate` is not null) and (`c01`.`tbl_order`.`BillDate` is not null))